# 笔记模块设计文档

## 1. 模块概述

### 1.1 功能描述
笔记模块以脑图形式展示个人学习笔记，不提供传统列表视图。

### 1.2 模块位置
- 脑图根节点列表页：/notes
- 脑图详情页：/notes/mindmap/{id}
- 页面文件：frontend/pages/notes/[...slug].js

## 2. 页面设计

### 2.1 脑图根节点列表页面

#### 页面结构
- 根节点卡片展示（标题+脑图截图）
- 创建新脑图按钮
- 搜索功能

#### 视觉设计
- 脑图根节点卡片采用科技感设计，带有微妙的渐变背景
- 卡片布局采用网格展示，支持响应式调整
- 搜索框采用深色主题设计

### 2.2 脑图详情页面

#### 页面结构
- 交互式脑图展示区域
- 节点详情查看面板
- 工具栏（缩放、全屏、导出等）

#### 视觉设计
- 脑图详情页面采用深色背景，节点使用不同颜色区分类型
- 节点连线使用浅绿色，与整体视觉风格保持一致
- 工具栏按钮使用简约设计，图标清晰易懂

## 3. 核心功能

### 3.1 脑图展示
- D3.js实现交互式脑图
- 支持节点拖拽和连接
- 支持缩放和平移操作

### 3.2 双向链接
- 笔记间建立关联关系
- 自动生成关键字关联链接
- 支持链接可视化展示

### 3.3 Markdown编辑
- 支持Markdown格式笔记内容
- 实时预览功能
- 代码高亮支持

### 3.4 多根节点
- 支持创建多个独立脑图
- 根节点管理功能
- 脑图间隔离展示

### 3.5 节点操作
- 创建、编辑、删除节点
- 节点属性设置
- 节点间链接管理

## 4. 数据结构

### 4.1 脑图根节点
- 标题、描述、截图路径
- 节点数量统计
- 创建和更新时间

### 4.2 脑图节点
- 节点标题和内容
- 父节点关系
- 坐标位置信息

### 4.3 节点链接
- 起始节点和目标节点
- 链接类型标识
- 创建时间

## 5. 接口设计

### 5.1 前端接口
- GET /api/notes/mindmap/roots - 获取脑图根节点列表
- GET /api/notes/mindmap/roots/{id}/data - 获取脑图数据
- POST /api/notes/mindmap/nodes - 创建节点
- PUT /api/notes/mindmap/nodes/{id} - 更新节点

### 5.2 后端接口
- GET /api/notes/mindmap/roots - 脑图根节点列表接口
- GET /api/notes/mindmap/roots/{id}/data - 脑图数据获取接口
- POST /api/notes/mindmap/nodes - 脑图节点创建接口
- PUT /api/notes/mindmap/nodes/{id} - 脑图节点更新接口

## 6. 性能优化

### 6.1 渲染优化
- 脑图节点虚拟渲染
- 大脑图分片加载
- 节点懒加载机制

### 6.2 数据优化
- 脑图数据缓存策略
- 节点数据压缩传输
- 增量数据更新

### 6.3 交互优化
- 脑图操作防抖处理
- 节点渲染性能监控
- 大数据量提示机制

## 7. 用户体验

### 7.1 交互设计
- 拖拽创建节点
- 双击编辑节点
- 右键菜单操作

### 7.2 可视化效果
- 节点高亮显示
- 链接动画效果
- 聚焦模式支持

### 7.3 辅助功能
- 快捷键支持
- 搜索节点功能
- 导出脑图功能